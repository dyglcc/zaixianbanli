package qfpay.wxshop.ui.main.fragment;import android.annotation.SuppressLint;import android.app.AlertDialog;import android.content.DialogInterface;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.webkit.JsResult;import android.webkit.WebChromeClient;import android.webkit.WebSettings;import android.webkit.WebView;import android.widget.ImageView;import android.widget.TextView;import org.androidannotations.annotations.AfterViews;import org.androidannotations.annotations.Click;import org.androidannotations.annotations.EFragment;import org.androidannotations.annotations.ViewById;import java.util.HashMap;import java.util.Map;import qfpay.wxshop.R;import qfpay.wxshop.WxShopApplication;import qfpay.wxshop.app.BaseFragment;import qfpay.wxshop.config.WDConfig;import qfpay.wxshop.utils.MobAgentTools;import qfpay.wxshop.utils.Utils;/** * 统计fragment * */@EFragment(R.layout.main_publish_goods)public class StatFragment extends BaseFragment {    @ViewById(R.id.load_fail)    View failView;    @ViewById(R.id.contact_webview)    WebView webView;    @ViewById    View layout_progress_load;    @ViewById(R.id.iv_progress_load)    ImageView ivProgress;    @ViewById    TextView tv_title;    @ViewById    View btn_back;    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {        return super.onCreateView(inflater, container, savedInstanceState);    }    @Override    public void onResume() {        super.onResume();    }    @Override    public void onFragmentRefresh() {        init();    }    private Map<String, String> header = new HashMap<String, String>();    @AfterViews    @SuppressLint("SetJavaScriptEnabled")    void init() {        MobAgentTools.OnEventMobOnDiffUser(getActivity(), "Order management");        tv_title.setText(getString(R.string.order_manage));        webView.getSettings().setJavaScriptEnabled(true);        webView.getSettings().setDefaultTextEncodingName("utf-8");        webView.getSettings().setBuiltInZoomControls(false);        webView.getSettings().setSupportZoom(false);        webView.getSettings().setCacheMode(WebSettings.LOAD_DEFAULT);        webView.getSettings().setDomStorageEnabled(true);        header.put("QFCOOKIE", "sessionid=" + WxShopApplication.dataEngine.getcid());        webView.setWebChromeClient(new WebChromeClient() {            @Override            public boolean onJsAlert(WebView view, String url, String message,                                     final JsResult result) {                AlertDialog.Builder b2 = new AlertDialog.Builder(getActivity())                        .setTitle(getString(R.string.hint))                        .setMessage(message)                        .setPositiveButton("ok",                                new AlertDialog.OnClickListener() {                                    @Override                                    public void onClick(DialogInterface dialog,                                                        int which) {                                        result.confirm();                                    }                                });                b2.setCancelable(false);                b2.create();                b2.show();                return true;            }        });        Utils.setCookies(WDConfig.getInstance().getStatURL(getActivity()), getActivity());        webView.loadUrl(WDConfig.getInstance().getStatURL(getActivity()), header);    }    @Click    void btn_back() {        if (webView.canGoBack()) {            webView.goBack();        }    }}